<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Đội Tuyển Tin - Note</title>
  <style>
    :root{
      --bg:#f6f2d4; --note:#fff6b2; --accent:#ff8a65; --shadow:rgba(0,0,0,0.18);
      --glass: rgba(255,255,255,0.6);
    }
    *{box-sizing:border-box; font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    body{
      margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center; 
      background:#1a1a2e; padding:32px; overflow:hidden; position:relative;
    }

    /* Animated gradient background */
    body::before{
      content:''; position:absolute; inset:0; z-index:0;
      background:linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);
      background-size:400% 400%; animation:gradientShift 15s ease infinite;
    }
    
    /* Floating geometric shapes */
    .bg-shape{
      position:absolute; border-radius:50%; opacity:0.1; animation:floatShape 20s infinite ease-in-out;
      background:linear-gradient(135deg, rgba(255,255,255,0.8), rgba(255,255,255,0.2));
      backdrop-filter:blur(20px);
    }
    .bg-shape:nth-child(1){width:300px; height:300px; top:10%; left:5%; animation-delay:0s; animation-duration:25s}
    .bg-shape:nth-child(2){width:200px; height:200px; top:60%; right:10%; animation-delay:3s; animation-duration:20s}
    .bg-shape:nth-child(3){width:150px; height:150px; bottom:15%; left:15%; animation-delay:6s; animation-duration:30s; border-radius:30%}
    .bg-shape:nth-child(4){width:250px; height:250px; top:40%; right:25%; animation-delay:9s; animation-duration:22s; border-radius:20%}

    @keyframes gradientShift{
      0%, 100%{background-position:0% 50%}
      50%{background-position:100% 50%}
    }
    @keyframes floatShape{
      0%, 100%{transform:translate(0, 0) rotate(0deg) scale(1)}
      25%{transform:translate(30px, -30px) rotate(90deg) scale(1.1)}
      50%{transform:translate(-20px, 40px) rotate(180deg) scale(0.9)}
      75%{transform:translate(40px, 20px) rotate(270deg) scale(1.05)}
    }

    .wrap{width:100%; max-width:95%; display:flex; align-items:center; justify-content:center; position:relative; z-index:1}

    /* Note preview */
    .note-wrap{position:relative; display:flex; align-items:center; justify-content:center; padding:36px; max-width:600px}
    .note{
      width:100%; min-height:360px; background:var(--note); border-radius:18px; padding:28px 30px; 
      box-shadow: 0 20px 60px rgba(0,0,0,0.3), 0 0 100px rgba(255,255,255,0.1);
      transform: rotate(-2deg); transition:all .4s cubic-bezier(0.34, 1.56, 0.64, 1); position:relative; overflow:hidden;
    }
    .note:before{
      content:''; position:absolute; inset:0; pointer-events:none; 
      background:linear-gradient(120deg, rgba(255,255,255,0.2), rgba(0,0,0,0.05)); 
      mix-blend-mode:overlay;
    }
    .note:after{
      content:''; position:absolute; top:-50%; left:-50%; width:200%; height:200%;
      background:radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
      opacity:0; transition:opacity 0.6s ease;
    }
    .note:hover:after{opacity:1; animation:shimmer 2s ease infinite}
    
    @keyframes shimmer{
      0%{transform:translate(-50%, -50%) rotate(0deg)}
      100%{transform:translate(50%, 50%) rotate(360deg)}
    }
    
    .note .title{font-size:22px; font-weight:700; margin-bottom:8px; color:#2b2b2b; text-shadow:1px 1px 2px rgba(255,255,255,0.5)}
    .note .content{white-space:pre-wrap; font-size:18px; line-height:1.45; color:#2b2b2b}
    .note .signature{text-align:center; margin-top:24px; font-size:14px; color:#666; font-style:italic}
    
    .edit-btn{
      position:absolute; top:16px; right:16px; width:44px; height:44px; border-radius:50%; 
      background:var(--accent); border:0; cursor:pointer; display:flex; align-items:center; 
      justify-content:center; box-shadow:0 4px 12px rgba(0,0,0,0.15);
      transition:all .3s cubic-bezier(0.68, -0.55, 0.265, 1.55); z-index:10;
    }
    .edit-btn:hover{transform:scale(1.15) rotate(90deg); box-shadow:0 8px 20px rgba(0,0,0,0.25)}
    .edit-btn:active{transform:scale(0.95) rotate(90deg)}
    .edit-btn svg{width:20px; height:20px; fill:white; transition:transform .3s ease}
    .edit-btn:hover svg{transform:rotate(-90deg)}

    /* controls */
    .panel{
      background:rgba(255,255,255,0.95); border-radius:12px; padding:18px; 
      box-shadow:0 10px 30px rgba(20,20,40,0.3), 0 0 100px rgba(255,255,255,0.1); 
      display:none; position:fixed; top:50%; right:24px; transform:translateY(-50%); width:320px; max-height:90vh; overflow-y:auto;
      z-index:100; backdrop-filter:blur(20px); border:1px solid rgba(255,255,255,0.3);
    }
    .panel.show{display:block; animation:slideInRight 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)}
    .panel h3{margin:0 0 12px 0; color:#2b2b2b}
    label{display:block; font-size:13px; margin:10px 0 6px; color:#444; font-weight:600}
    input[type=text], textarea, select{
      width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e6e6e6; 
      font-size:14px; transition:all .2s ease; background:rgba(255,255,255,0.9);
    }
    input[type=text]:focus, textarea:focus, select:focus{
      outline:none; border-color:var(--accent); 
      box-shadow:0 0 0 3px rgba(255,138,101,0.2), 0 4px 12px rgba(255,138,101,0.1);
      background:white;
    }
    textarea{min-height:140px; resize:vertical}
    .row{display:flex; gap:8px}
    .btn{
      appearance:none; border:0; padding:10px 12px; border-radius:8px; cursor:pointer; 
      font-weight:600; transition:all .3s ease; position:relative; overflow:hidden;
    }
    .btn:before{
      content:''; position:absolute; inset:0; background:rgba(255,255,255,0.3);
      transform:translateX(-100%); transition:transform 0.3s ease;
    }
    .btn:hover:before{transform:translateX(100%)}
    .btn:hover{transform:translateY(-2px); box-shadow:0 6px 20px rgba(0,0,0,0.2)}
    .btn:active{transform:translateY(0)}
    .btn-primary{background:linear-gradient(135deg, #ff8a65, #ff6b6b); color:white; box-shadow:0 4px 15px rgba(255,107,107,0.3)}
    .btn-primary:hover{box-shadow:0 6px 25px rgba(255,107,107,0.4)}
    .btn-ghost{background:rgba(255,255,255,0.8); border:1px solid #ddd; color:#333}
    .colors{display:flex; gap:8px; margin-top:8px; flex-wrap:wrap}
    .swatch{
      width:36px; height:36px; border-radius:8px; cursor:pointer; 
      border:2px solid rgba(255,255,255,0.5); transition:all .3s ease; position:relative;
      box-shadow:0 2px 8px rgba(0,0,0,0.2);
    }
    .swatch:hover{transform:scale(1.2) rotate(10deg); box-shadow:0 4px 15px rgba(0,0,0,0.3)}
    .swatch.active{border-color:#ff6b6b; border-width:3px; transform:scale(1.1)}
    .swatch.active:after{
      content:'✓'; position:absolute; inset:0; display:flex; align-items:center; 
      justify-content:center; color:white; font-weight:bold; font-size:16px;
      text-shadow:0 2px 4px rgba(0,0,0,0.5);
    }
    .meta{margin-top:12px; color:#666; font-size:13px}

    /* animations */
    @keyframes fadeInUp{
      from{opacity:0; transform:translateY(30px)}
      to{opacity:1; transform:translateY(0)}
    }
    @keyframes slideInRight{
      from{opacity:0; transform:translateY(-50%) translateX(30px)}
      to{opacity:1; transform:translateY(-50%) translateX(0)}
    }
    @keyframes float{
      0%, 100%{transform:translateY(0) rotate(-2deg)}
      50%{transform:translateY(-10px) rotate(-2deg)}
    }
    @keyframes sparkle{
      0%, 100%{opacity:0; transform:scale(0) rotate(0deg)}
      50%{opacity:1; transform:scale(1) rotate(180deg)}
    }
    @keyframes confetti{
      0%{transform:translateY(-100vh) rotate(0deg); opacity:1}
      100%{transform:translateY(100vh) rotate(720deg); opacity:0}
    }
    body{animation:fadeInUp 0.8s ease-out}
    .note-wrap{animation:fadeInUp 1s ease-out 0.2s backwards}
    .note{animation:float 4s ease-in-out infinite}
    .sparkle{
      position:absolute; width:8px; height:8px; background:white; border-radius:50%;
      pointer-events:none; animation:sparkle 3s ease-in-out infinite;
      box-shadow:0 0 15px rgba(255,255,255,0.9), 0 0 30px currentColor;
    }
    .confetti{
      position:fixed; width:12px; height:12px; pointer-events:none;
      animation:confetti 3s linear forwards; z-index:1000; border-radius:2px;
    }

    /* music control */
    .music-btn{
      position:fixed; bottom:24px; left:24px; width:56px; height:56px; border-radius:50%;
      background:linear-gradient(135deg, #ff8a65, #ff6b6b); border:0; cursor:pointer; 
      display:flex; align-items:center; justify-content:center; 
      box-shadow:0 6px 25px rgba(255,107,107,0.4), 0 0 40px rgba(255,138,101,0.2); z-index:200;
      transition:all .3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    .music-btn:hover{transform:scale(1.15); box-shadow:0 8px 30px rgba(255,107,107,0.5), 0 0 60px rgba(255,138,101,0.3)}
    .music-btn svg{width:24px; height:24px; fill:white; transition:transform .3s ease; filter:drop-shadow(0 2px 4px rgba(0,0,0,0.2))}
    .music-btn.playing{animation:pulse 1.5s ease-in-out infinite}
    .music-btn.playing svg{animation:spin 3s linear infinite}
    
    /* arrow pointer */
    .music-pointer{
      position:fixed; bottom:90px; left:10px; z-index:199; display:flex; flex-direction:column; align-items:center; gap:4px;
      animation:bouncePointer 1.5s ease-in-out infinite;
    }
    .music-pointer-text{
      background:linear-gradient(135deg, #667eea, #764ba2); color:white; padding:8px 14px; border-radius:20px;
      font-size:13px; font-weight:700; white-space:nowrap; 
      box-shadow:0 4px 15px rgba(102,126,234,0.5), 0 0 30px rgba(118,75,162,0.3);
      transform:rotate(-8deg); position:relative; border:2px solid rgba(255,255,255,0.3);
    }
    .music-pointer-text:before{
      content:''; position:absolute; bottom:-8px; left:22px; width:0; height:0;
      border-left:8px solid transparent; border-right:8px solid transparent; border-top:10px solid #764ba2;
      transform:rotate(15deg); filter:drop-shadow(0 2px 4px rgba(0,0,0,0.2));
    }
    .music-pointer-arrow{
      font-size:32px; filter:drop-shadow(0 3px 6px rgba(0,0,0,0.3));
      animation:wiggle 0.8s ease-in-out infinite;
    }
    
    @keyframes pulse{
      0%, 100%{box-shadow:0 6px 25px rgba(255,107,107,0.4), 0 0 40px rgba(255,138,101,0.2)}
      50%{box-shadow:0 6px 40px rgba(255,107,107,0.7), 0 0 80px rgba(255,138,101,0.5)}
    }
    @keyframes spin{
      from{transform:rotate(0deg)}
      to{transform:rotate(360deg)}
    }
    @keyframes bouncePointer{
      0%, 100%{transform:translateY(0)}
      50%{transform:translateY(-10px)}
    }
    @keyframes wiggle{
      0%, 100%{transform:rotate(0deg) scale(1)}
      25%{transform:rotate(-20deg) scale(1.1)}
      75%{transform:rotate(20deg) scale(1.1)}
    }

    /* floating particles */
    .particle{
      position:fixed; border-radius:50%; pointer-events:none; animation:floatParticle 15s infinite;
      box-shadow:0 0 10px currentColor;
    }
    @keyframes floatParticle{
      0%{transform:translateY(100vh) translateX(0) scale(0) rotate(0deg); opacity:0}
      10%{opacity:1}
      90%{opacity:1}
      100%{transform:translateY(-100vh) translateX(100px) scale(1) rotate(360deg); opacity:0}
    }

    /* responsive */
    @media (max-width:880px){
      .note{min-height:320px}
      .panel{right:12px; left:12px; width:auto; top:auto; bottom:12px; transform:none; max-height:70vh}
      .panel.show{animation:slideInUp 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)}
      .music-btn{bottom:16px; left:16px; width:48px; height:48px}
      .music-pointer{bottom:70px; left:4px}
      .music-pointer-text{font-size:11px; padding:6px 10px}
      .music-pointer-arrow{font-size:26px}
      @keyframes slideInUp{
        from{opacity:0; transform:translateY(30px)}
        to{opacity:1; transform:translateY(0)}
      }
    }
  </style>
</head>
<body>
  <!-- Background shapes -->
  <div class="bg-shape"></div>
  <div class="bg-shape"></div>
  <div class="bg-shape"></div>
  <div class="bg-shape"></div>

  <!-- Music pointer arrow -->
  <div class="music-pointer">
    <div class="music-pointer-text">🎵 Phát nhạc ở đây!</div>
    <div class="music-pointer-arrow">👇</div>
  </div>

  <!-- Music button -->
  <button id="musicBtn" class="music-btn playing" aria-label="Phát nhạc" title="Click để tắt nhạc">
    <svg id="playIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="display:none">
      <path d="M8 5v14l11-7z"/>
    </svg>
    <svg id="pauseIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
    </svg>
  </button>

  <audio id="bgMusic" loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3" type="audio/mpeg">
  </audio>

  <div class="wrap">
    <div class="note-wrap">
      <div id="note" class="note" role="region" aria-label="Preview note">
        <div class="title" id="noteTitle">Gửi đội tuyển tin</div>
        <div class="content" id="noteContent">Chúc các thành viên đội tuyển Tin học tự tin, bình tĩnh và tỏa sáng trong kì thi chọn đội dự tuyển HSG Quốc gia! Hãy phát huy hết khả năng, tư duy logic sắc bén và tinh thần đồng đội vững mạnh. Chúc các bạn đạt kết quả cao và mang vinh quang về cho đội tuyển!</div>
        <div class="signature">-By Đội Tuyển Tin-</div>
      </div>
      <button id="editBtn" class="edit-btn" aria-label="Chỉnh sửa" title="Chỉnh sửa Note">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
        </svg>
      </button>
    </div>

    <div class="panel" aria-hidden="false">
      <h3>✨ Chỉnh sửa Note</h3>

      <label for="titleInput">📝 Tiêu đề</label>
      <input id="titleInput" type="text" placeholder="Ví dụ: Gửi đội tuyển tin" />

      <label for="contentInput">💬 Nội dung (dùng Enter để xuống dòng)</label>
      <textarea id="contentInput" placeholder="Viết lời chúc..." ></textarea>

      <label>🎨 Màu nền note</label>
      <div class="colors">
        <button class="swatch active" data-color="#fff6b2" style="background:#fff6b2" title="Vàng nhạt"></button>
        <button class="swatch" data-color="#ffd7e2" style="background:#ffd7e2" title="Hồng pastel"></button>
        <button class="swatch" data-color="#d6f8e8" style="background:#d6f8e8" title="Xanh mint"></button>
        <button class="swatch" data-color="#dfe7ff" style="background:#dfe7ff" title="Xanh lavender"></button>
        <button class="swatch" data-color="#fff3d1" style="background:#fff3d1" title="Kem"></button>
        <button class="swatch" data-color="#ffe4e1" style="background:#ffe4e1" title="Hồng đào"></button>
      </div>

      <label for="fontSelect">✍️ Phông chữ</label>
      <select id="fontSelect">
        <option value="Inter, system-ui, -apple-system, 'Segoe UI', Roboto">Inter (mặc định)</option>
        <option value="'Segoe Script', cursive">Segoe Script (viết tay)</option>
        <option value="Georgia, 'Times New Roman', serif">Georgia (trang trọng)</option>
      </select>

      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap">
        <button id="saveBtn" class="btn btn-primary">💾 Lưu</button>
        <button id="downloadBtn" class="btn btn-ghost">⬇️ Tải HTML</button>
        <button id="printBtn" class="btn btn-ghost">🖨️ In/PDF</button>
        <button id="resetBtn" class="btn btn-ghost">🔄 Đặt lại</button>
      </div>

      <div class="meta">© 2025 Đội tuyển Tin</div>
    </div>
  </div>

  <script>
    // Elements
    const note = document.getElementById('note');
    const titleEl = document.getElementById('noteTitle');
    const contentEl = document.getElementById('noteContent');
    const titleInput = document.getElementById('titleInput');
    const contentInput = document.getElementById('contentInput');
    const fontSelect = document.getElementById('fontSelect');
    const swatches = document.querySelectorAll('.swatch');
    const saveBtn = document.getElementById('saveBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const printBtn = document.getElementById('printBtn');
    const resetBtn = document.getElementById('resetBtn');
    const editBtn = document.getElementById('editBtn');
    const panel = document.querySelector('.panel');
    const musicBtn = document.getElementById('musicBtn');
    const bgMusic = document.getElementById('bgMusic');
    const playIcon = document.getElementById('playIcon');
    const pauseIcon = document.getElementById('pauseIcon');

    const STORAGE_KEY = 'note_loi_chuc_v1';
    let isPlaying = false;

    // Color themes for matching note colors
    const colorThemes = {
      '#fff6b2': { accent: '#ffb347', sparkle: '#ffd700' }, // Vàng
      '#ffd7e2': { accent: '#ff69b4', sparkle: '#ff1493' }, // Hồng
      '#d6f8e8': { accent: '#3cb371', sparkle: '#00fa9a' }, // Xanh mint
      '#dfe7ff': { accent: '#6a5acd', sparkle: '#7b68ee' }, // Xanh lavender
      '#fff3d1': { accent: '#ffa500', sparkle: '#ffd700' }, // Kem
      '#ffe4e1': { accent: '#ff6b9d', sparkle: '#ff1493' }  // Hồng đào
    };

    // Create sparkles
    function createSparkles(){
      const wrap = document.querySelector('.note-wrap');
      const existingSparkles = wrap.querySelectorAll('.sparkle');
      existingSparkles.forEach(s => s.remove());
      
      const currentColor = note.style.background || '#fff6b2';
      const theme = colorThemes[currentColor] || colorThemes['#fff6b2'];
      
      for(let i=0; i<15; i++){
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        sparkle.style.left = Math.random() * 100 + '%';
        sparkle.style.top = Math.random() * 100 + '%';
        sparkle.style.animationDelay = Math.random() * 3 + 's';
        sparkle.style.width = (4 + Math.random() * 4) + 'px';
        sparkle.style.height = sparkle.style.width;
        sparkle.style.color = theme.sparkle;
        wrap.appendChild(sparkle);
      }
    }

    // Create floating particles
    function createParticles(){
      const existingParticles = document.querySelectorAll('.particle');
      existingParticles.forEach(p => p.remove());
      
      const currentColor = note.style.background || '#fff6b2';
      const theme = colorThemes[currentColor] || colorThemes['#fff6b2'];
      
      for(let i=0; i<20; i++){
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 15 + 's';
        particle.style.animationDuration = (10 + Math.random() * 10) + 's';
        particle.style.width = (3 + Math.random() * 5) + 'px';
        particle.style.height = particle.style.width;
        particle.style.background = theme.accent;
        particle.style.color = theme.accent;
        document.body.appendChild(particle);
      }
    }

    // Create confetti effect
    function createConfetti(){
      const currentColor = note.style.background || '#fff6b2';
      const theme = colorThemes[currentColor] || colorThemes['#fff6b2'];
      const colors = [theme.accent, theme.sparkle, '#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#6c5ce7'];
      
      for(let i=0; i<40; i++){
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + '%';
        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.animationDelay = Math.random() * 0.5 + 's';
        confetti.style.animationDuration = (2 + Math.random() * 1) + 's';
        document.body.appendChild(confetti);
        setTimeout(() => confetti.remove(), 3500);
      }
    }

    // Auto play music on load
    window.addEventListener('load', () => {
      bgMusic.play().then(() => {
        isPlaying = true;
        musicBtn.classList.add('playing');
        playIcon.style.display = 'none';
        pauseIcon.style.display = 'block';
        musicBtn.title = 'Click để tắt nhạc';
      }).catch(e => {
        console.log('Trình duyệt chặn auto-play:', e);
        isPlaying = false;
        musicBtn.classList.remove('playing');
        playIcon.style.display = 'block';
        pauseIcon.style.display = 'none';
        musicBtn.title = 'Click để bật nhạc';
      });
    });

    // Music control
    musicBtn.addEventListener('click', ()=>{
      if(isPlaying){
        bgMusic.pause();
        playIcon.style.display = 'block';
        pauseIcon.style.display = 'none';
        musicBtn.classList.remove('playing');
        musicBtn.title = 'Click để bật nhạc';
      } else {
        bgMusic.play().catch(e => console.log('Không thể phát nhạc:', e));
        playIcon.style.display = 'none';
        pauseIcon.style.display = 'block';
        musicBtn.classList.add('playing');
        musicBtn.title = 'Click để tắt nhạc';
      }
      isPlaying = !isPlaying;
    });

    // Set volume
    bgMusic.volume = 0.3;

    // Toggle panel
    editBtn.addEventListener('click', ()=>{
      panel.classList.toggle('show');
    });

    // Update edit button color based on note background
    function updateEditButtonColor(bgColor){
      const theme = colorThemes[bgColor] || colorThemes['#fff6b2'];
      editBtn.style.background = theme.accent;
      editBtn.style.boxShadow = `0 4px 15px ${theme.accent}40`;
    }

    // Load defaults or saved
    function load() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if(raw) {
        try { const s = JSON.parse(raw);
          titleEl.textContent = s.title || titleEl.textContent;
          contentEl.textContent = s.content || contentEl.textContent;
          const bgColor = s.bg || '#fff
